--- env.c	2006-03-14 01:42:37.000000000 -0800
+++ env.c	2006-06-28 17:17:58.000000000 -0700
@@ -48,6 +48,12 @@
 	}
     }
 
+    if (argv[0]==NULL)
+    {
+        fprintf(stderr,"fetchmail: bad program name\n");
+        exit(PS_UNDEFINED);
+    }
+
     if ((program_name = strrchr(argv[0], '/')) != NULL)
 	++program_name;
     else
